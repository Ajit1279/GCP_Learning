- References: https://cloud.google.com/bigquery/docs

- Basics:
  - Google Cloud's fully managed, petabyte-scale, and cost-effective analytics data warehouse
  - Lets you **run analytics** over **vast amounts of data** in **near real time**.
  - Key features of BigQuery's architecture is the **separation of storage and compute**, thus allowing them **to scale independently** 

- How does BigQuery Work?
  - **[Storage](https://cloud.google.com/bigquery/docs/storage_overview)**
    - Optimized for running analytic queries over large datasets.
    - Stores table data in **columnar format (each column separately)**.
    - Supports **high-throughput streaming ingestion and reads**
    - **Key Features:**
      - **Managed**: A completely google managesd service. You don't need to provision storage resources
      - **Durable**: 99.999999999% **(11 9's)** annual durability. Replicates data across multiple availability zones.
      - **Encrypted**: automatically encrypts all data before it is written to disk (uing your or google managed encryption key).
      - **Efficient:** Uses an efficient encoding format that is optimized for analytic workloads.
    - Majority of the data that you store in BigQuery is [table data](https://cloud.google.com/bigquery/docs/storage_overview#table_data):
      - BigQuery writes all query results to a table, either explicitly identified by user or temporary table. 
      - [Standard tables](https://cloud.google.com/bigquery/docs/tables-intro#standard_tables):
        - Contain structured data and are stored in BigQuery storage in a columnar format.  
      - [Table Clones](https://cloud.google.com/bigquery/docs/table-clones-intro)
        - **Lightweight, writable copy** of another table (called the base table).
        - It is **independent of the base table** (Any changes made to the base table or table clone aren't reflected in the other.)
        - Only **charged for storage of data** in the table clone
        - Use Cases:
          - Creating **copies** of production tables **for development and testing**
          - Creating **sandboxes** for users for **own analytics and data manipulations**
        - [Create Clone Table](https://cloud.google.com/bigquery/docs/table-clones-create#bq) 
      - [Table Snapshots](https://cloud.google.com/bigquery/docs/table-snapshots-intro)
        - **Read-only copy of a table (base table)** at a particular time (upto past 7 days)
        - **Requires less storage** (only stores bytes that are different from base table)
        - [Create Table snapshots](https://cloud.google.com/bigquery/docs/table-snapshots-create)
      - [Materialized Views](https://cloud.google.com/bigquery/docs/materialized-views-intro)
        - **Cache the results of a query for increased performance and efficiency**.
        - **Use Cases:** Predictable and repeated queries e.g. pre-aggregated data, pre-filter data, pre-join data, Recluster data. 
        - Advantages:
          - **Zero maintenance** (Changes automatically added to the views)
          - **Return Fresh data** (From view or from base table if view invalidated)
          - **[Smart Tuning](https://cloud.google.com/bigquery/docs/materialized-views-use#smart_tuning)**: Route to view instead of base table for better efficiency. 
      - [Temporary tables/ cached query results](https://cloud.google.com/bigquery/docs/cached-results)
        - All query results, (interactive or batch) are cached in temporary tables for approximately 24 hours.
        - except if:
          - Destination table is specified
          - Referenced tables or logical views have changed after results cached
          - Referenced table received streaming inserts
          - If the query uses non-deterministic functions; for example, date and time functions
          - If the query runs against an external data source.
        - If you run the exact same query again, BigQuery returns the results from the cached table, if it exists.
        - Maintained per-user per-project
        - No storage costs 
      - [External Tables](https://cloud.google.com/bigquery/docs/external-data-sources#external_tables)
        - Similar to standard BigQuery tables, however their data resides in an external source.
        - Like standard bigquery table, you can view the table's properties, set access controls and so forth.
        - Three kinds of external tables:
          - [BigLake tables](https://cloud.google.com/bigquery/docs/biglake-intro):
          - [Object tables](https://cloud.google.com/bigquery/docs/object-table-introduction): Read-only tables over unstructured data objects that reside in Cloud Storage.
          - Non-BigLake external tables: Query structured data in external data stores  
    - [Metadata](https://cloud.google.com/bigquery/docs/storage_overview#metadata): Holds metadata about your BigQuery resources, not chareable.
    - [Read data from BigQuery storage using](https://cloud.google.com/bigquery/docs/storage_overview#reading_data): BigQuery API, BigQuery API Storage, Export, Copy
    - [Deletion](https://cloud.google.com/bigquery/docs/storage_overview#deletion): When you delete a table, the data persists for at least the duration of your time travel window.  

  - **[Analytics](https://cloud.google.com/bigquery/docs/query-overview)**
    - Adhoc analysis using [GoogleSQL](https://cloud.google.com/bigquery/docs/reference/standard-sql/migrating-from-legacy-sql)
    - [Geospatial analysis](https://cloud.google.com/bigquery/docs/geospatial-intro): Analyze and visualize geospatial data.
    - Machine Learning: Create and Execute Machine Learning models using [BigQuery ML](https://cloud.google.com/bigquery/docs/bqml-introduction)
    - Business Intelligence: Build rich, interactive dashboards and reports using [BigQuery BI Engine](https://cloud.google.com/bigquery/docs/bi-engine-intro)
    - [Query Jobs:](https://cloud.google.com/bigquery/docs/query-overview#query_jobs)
      - Actions that BigQuery runs on your behalf to load data, export data, query data, or copy data.
      - [Types of Queries:](https://cloud.google.com/bigquery/docs/query-overview#types_of_queries)
        - [Interactive Query Jobs:](https://cloud.google.com/bigquery/docs/running-queries#queries)
        - [Batch Query Jobs:](https://cloud.google.com/bigquery/docs/running-queries#batch)
    - Several [processes](https://cloud.google.com/bigquery/docs/query-overview#query_processing) occur when bigQuery runs a query: Execution Tree, Shuffle Tier, Query Plan, Query Monitoring & Dynamic Planning, Query Results
    - [Query Concurrancy and performance](https://cloud.google.com/bigquery/docs/query-overview#query_concurrency_and_performance): BigQuery runs many queries in parallel. As queries start and finish, BigQuery redistributes resources fairly between new and running queries.
    - [Query Optimization:](https://cloud.google.com/bigquery/docs/query-overview#query_optimization) The [query plan](https://cloud.google.com/bigquery/docs/query-insights) includes details about query stages and steps. These details can help you identify ways to improve [query performance](https://cloud.google.com/bigquery/docs/best-practices-performance-overview).
    - [Query Monitoring:](https://cloud.google.com/bigquery/docs/monitoring): BigQuery provides various metrics, logs, and metadata views to help you monitor your BigQuery usage
    - Query Pricing: Offers [On-demand pricing](https://cloud.google.com/bigquery/pricing#on_demand_pricing), [Capacity-based pricing](https://cloud.google.com/bigquery/pricing#capacity_compute_analysis_pricing)        
    - It lets you query data in various [data sources](https://cloud.google.com/bigquery/docs/query-overview#data_sources) like: BigQuery, External Data, Multi-cloud data, Public Datasets
    -  

  - Administration
    - [Manage BigQuery Resources](https://cloud.google.com/bigquery/docs/resource-hierarchy) (organizations, folders, projects, datasets, and tables)
    - Manage Datasets: Datasets are containers for tables. Create tables in a dataset, and then manage them as a group. For example, Configure a dataset's default table expiration time, which applies to all tables in the dataset.
    -  

  - When you run a query:
    - **Query Engine** distributes the work in parallel across multiple workers
    - **Workers** scan the relevant tables in storage, process the query, and then gather the results.
    - **Petabit network** ensure that data moves extremely quickly to the worker nodes.  


- Hands-on:
  - [Query a public dataset with a bq tool](https://github.com/Ajit1279/GCP_Learning/tree/main/20240316_BigDataAnalytics/240420_BigQuery/240425_PublicDataset)
  - [Create BigQuery Resources (Datasets, tables etc.)](https://github.com/Ajit1279/GCP_Learning/tree/main/20240316_BigDataAnalytics/240420_BigQuery/240427_CreateBQResources)
  - [BigLake: Qwik Start](https://www.cloudskillsboost.google/focuses/37985?parent=catalog)
  - 
